<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.8.1: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7056 2011-06-17 10:50:48Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">rst-ca/list-cons.ca.rst</tt>, line 1)</p>
<p>Malformed table.</p>
<pre class="literal-block">
+----------------------------------+----+-------------------------+
| Advanced Bash-Scripting Guide:   |
+==================================+====+=========================+
| `Prev &lt;aliases.html&gt;`_           |    | `Next &lt;arrays.html&gt;`_   |
+----------------------------------+----+-------------------------+
</pre>
</div>
<hr class="docutils" />
<div class="section" id="chapter-26-list-constructs">
<h1>Chapter 26. List Constructs</h1>
<p>The <em>and list</em> and <em>or list</em> constructs provide a means of processing a
number of commands consecutively. These can effectively replace complex
nested <a class="reference external" href="testconstructs.html#TESTCONSTRUCTS1">if/then</a> or even
<a class="reference external" href="testbranch.html#CASEESAC1">case</a> statements.</p>
<p><strong>Chaining together commands</strong></p>
<p>and list</p>
<blockquote>
<pre class="literal-block">
command-1 &amp;&amp; command-2 &amp;&amp; command-3 &amp;&amp; ... command-n
</pre>
<p>Each command executes in turn, provided that the previous command
has given a return value of <tt class="docutils literal">true</tt> (zero). At the first <tt class="docutils literal">false</tt>
(non-zero) return, the command chain terminates (the first command
returning <tt class="docutils literal">false</tt> is the last one to execute).</p>
<p>An interesting use of a two-condition <em>and list</em> from YongYe's
<a class="reference external" href="http://bash.deta.in/Tetris_Game.sh">Tetris game script</a>:</p>
<pre class="literal-block">
equation()

{  # core algorithm used for doubling and halving the coordinates
   [[ ${cdx} ]] &amp;&amp; ((y=cy+(ccy-cdy)${2}2))
   eval ${1}+=\&quot;${x} ${y} \&quot;
}
</pre>
<p><strong>Example 26-1. Using an *and list* to test for command-line
arguments</strong></p>
<pre class="literal-block">
#!/bin/bash
# and list

if [ ! -z &quot;$1&quot; ] &amp;&amp; echo &quot;Argument #1 = $1&quot; &amp;&amp; [ ! -z &quot;$2&quot; ] &amp;&amp; \
#                ^^                         ^^               ^^
echo &quot;Argument #2 = $2&quot;
then
  echo &quot;At least 2 arguments passed to script.&quot;
  # All the chained commands return true.
else
  echo &quot;Fewer than 2 arguments passed to script.&quot;
  # At least one of the chained commands returns false.
fi
# Note that &quot;if [ ! -z $1 ]&quot; works, but its alleged equivalent,
#   &quot;if [ -n $1 ]&quot; does not.
#     However, quoting fixes this.
#  if &quot;[ -n &quot;$1&quot; ]&quot; works.
#           ^  ^    Careful!
# It is always best to QUOTE the variables being tested.


# This accomplishes the same thing, using &quot;pure&quot; if/then statements.
if [ ! -z &quot;$1&quot; ]
then
  echo &quot;Argument #1 = $1&quot;
fi
if [ ! -z &quot;$2&quot; ]
then
  echo &quot;Argument #2 = $2&quot;
  echo &quot;At least 2 arguments passed to script.&quot;
else
  echo &quot;Fewer than 2 arguments passed to script.&quot;
fi
# It's longer and more ponderous than using an &quot;and list&quot;.


exit $?
</pre>
<p><strong>Example 26-2. Another command-line arg test using an *and list*</strong></p>
<pre class="literal-block">
#!/bin/bash

ARGS=1        # Number of arguments expected.
E_BADARGS=85  # Exit value if incorrect number of args passed.

test $# -ne $ARGS &amp;&amp; \
#    ^^^^^^^^^^^^ condition #1
echo &quot;Usage: `basename $0` $ARGS argument(s)&quot; &amp;&amp; exit $E_BADARGS
#                                             ^^
#  If condition #1 tests true (wrong number of args passed to script),
#+ then the rest of the line executes, and script terminates.

# Line below executes only if the above test fails.
echo &quot;Correct number of arguments passed to this script.&quot;

exit 0

# To check exit value, do a &quot;echo $?&quot; after script termination.
</pre>
<p>Of course, an <em>and list</em> can also <em>set</em> variables to a default
value.</p>
<pre class="literal-block">
arg1=$&#64; &amp;&amp; [ -z &quot;$arg1&quot; ] &amp;&amp; arg1=DEFAULT

              # Set $arg1 to command-line arguments, if any.
              # But . . . set to DEFAULT if not specified on command-line.
</pre>
</blockquote>
<p>or list</p>
<blockquote>
<pre class="literal-block">
command-1 || command-2 || command-3 || ... command-n
</pre>
<p>Each command executes in turn for as long as the previous command
returns false. At the first true return, the command chain
terminates (the first command returning true is the last one to
execute). This is obviously the inverse of the &quot;and list&quot;.</p>
<p><strong>Example 26-3. Using *or lists* in combination with an *and list*</strong></p>
<pre class="literal-block">
#!/bin/bash

#  delete.sh, a not-so-cunning file deletion utility.
#  Usage: delete filename

E_BADARGS=85

if [ -z &quot;$1&quot; ]
then
  echo &quot;Usage: `basename $0` filename&quot;
  exit $E_BADARGS  # No arg? Bail out.
else
  file=$1          # Set filename.
fi


[ ! -f &quot;$file&quot; ] &amp;&amp; echo &quot;File \&quot;$file\&quot; not found. \
Cowardly refusing to delete a nonexistent file.&quot;
# AND LIST, to give error message if file not present.
# Note echo message continuing on to a second line after an escape.

[ ! -f &quot;$file&quot; ] || (rm -f $file; echo &quot;File \&quot;$file\&quot; deleted.&quot;)
# OR LIST, to delete file if present.

# Note logic inversion above.
# AND LIST executes on true, OR LIST on false.

exit $?
</pre>
<div class="figure align-center">
<img alt="Caution" src="http://tldp.org/LDP/abs/images/caution.gif" />
<p class="caption">Caution</p>
</div>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">rst-ca/list-cons.ca.rst</tt>, line 167)</p>
Explicit markup ends without a blank line; unexpected unindent.</div>
<p>If the first command in an <em>or list</em> returns true, it <tt class="docutils literal">will</tt>
execute.</p>
</blockquote>
<pre class="literal-block">
# ==&gt; The following snippets from the /etc/rc.d/init.d/single
#+==&gt; script by Miquel van Smoorenburg
#+==&gt; illustrate use of &quot;and&quot; and &quot;or&quot; lists.
# ==&gt; &quot;Arrowed&quot; comments added by document author.

[ -x /usr/bin/clear ] &amp;&amp; /usr/bin/clear
  # ==&gt; If /usr/bin/clear exists, then invoke it.
  # ==&gt; Checking for the existence of a command before calling it
  #+==&gt; avoids error messages and other awkward consequences.

  # ==&gt; . . .

# If they want to run something in single user mode, might as well run it...
for i in /etc/rc1.d/S[0-9][0-9]* ; do
        # Check if the script is there.
        [ -x &quot;$i&quot; ] || continue
  # ==&gt; If corresponding file in $PWD *not* found,
  #+==&gt; then &quot;continue&quot; by jumping to the top of the loop.

        # Reject backup files and files generated by rpm.
        case &quot;$1&quot; in
                *.rpmsave|*.rpmorig|*.rpmnew|*~|*.orig)
                        continue;;
        esac
        [ &quot;$i&quot; = &quot;/etc/rc1.d/S00single&quot; ] &amp;&amp; continue
  # ==&gt; Set script name, but don't execute it yet.
        $i start
done

  # ==&gt; . . .
</pre>
<div class="figure align-center">
<img alt="Important" src="http://tldp.org/LDP/abs/images/important.gif" />
<p class="caption">Important</p>
</div>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">rst-ca/list-cons.ca.rst</tt>, line 208)</p>
Explicit markup ends without a blank line; unexpected unindent.</div>
<p>The <a class="reference external" href="exit-status.html#EXITSTATUSREF">exit status</a> of an <tt class="docutils literal">and list</tt>
or an <tt class="docutils literal">or list</tt> is the exit status of the last command executed.</p>
<p>Clever combinations of <em>and</em> and <em>or</em> lists are possible, but the logic
may easily become convoluted and require close attention to <a class="reference external" href="opprecedence.html#OPPRECEDENCE1">operator
precedence rules</a>, and possibly
extensive debugging.</p>
<pre class="literal-block">
false &amp;&amp; true || echo false         # false

# Same result as
( false &amp;&amp; true ) || echo false     # false
# But NOT
false &amp;&amp; ( true || echo false )     # (nothing echoed)

#  Note left-to-right grouping and evaluation of statements,
#+ since the logic operators &quot;&amp;&amp;&quot; and &quot;||&quot; have equal precedence.

#  It's usually best to avoid such complexities.

#  Thanks, S.C.
</pre>
<p>See <a class="reference external" href="contributed-scripts.html#DAYSBETWEEN">Example A-7</a> and <a class="reference external" href="fto.html#BROKENLINK">Example
7-4</a> for illustrations of using
<tt class="docutils literal">and&nbsp;&nbsp;&nbsp;&nbsp; / or list</tt> constructs to test variables.</p>
<hr class="docutils" />
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="32%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr><td><a class="reference external" href="aliases.html">Prev</a></td>
<td><a class="reference external" href="index.html">Home</a></td>
<td><a class="reference external" href="arrays.html">Next</a></td>
</tr>
<tr><td>Aliases</td>
<td><a class="reference external" href="part5.html">Up</a></td>
<td>Arrays</td>
</tr>
</tbody>
</table>
</div>
</div>
</body>
</html>
