<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.8.1: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7056 2011-06-17 10:50:48Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">rst-ca/devref1.ca.rst</tt>, line 1)</p>
<p>Malformed table.</p>
<pre class="literal-block">
+----------------------------------+--------------------------------------+---------------------------+
| Advanced Bash-Scripting Guide:   |
+==================================+======================================+===========================+
| `Prev &lt;devproc.html&gt;`_           | Chapter 29. ``/dev`` and ``/proc``   | `Next &lt;procref1.html&gt;`_   |
+----------------------------------+--------------------------------------+---------------------------+
</pre>
</div>
<hr class="docutils" />
<div class="section" id="dev">
<h1>29.1. <tt class="docutils literal">/dev</tt></h1>
<p>The <tt class="docutils literal">/dev</tt> directory contains entries for the <em>physical devices</em> that
may or may not be present in the hardware.
<a class="reference external" href="devref1.html#FTN.AEN18908">[1]</a> Appropriately enough, these are
called <em>device files</em>. As an example, the hard drive partitions
containing the mounted filesystem(s) have entries in <tt class="docutils literal">/dev</tt>, as
<a class="reference external" href="system.html#DFREF">df</a> shows.</p>
<pre class="literal-block">
bash$ df
Filesystem           1k-blocks      Used Available Use%
 Mounted on
 /dev/hda6               495876    222748    247527  48% /
 /dev/hda1                50755      3887     44248   9% /boot
 /dev/hda8               367013     13262    334803   4% /home
 /dev/hda5              1714416   1123624    503704  70% /usr
</pre>
<p>Among other things, the <tt class="docutils literal">/dev</tt> directory contains <em>loopback</em> devices,
such as <tt class="docutils literal">/dev/loop0</tt>. A loopback device is a gimmick that allows an
ordinary file to be accessed as if it were a block device.
<a class="reference external" href="devref1.html#FTN.AEN18928">[2]</a> This permits mounting an entire
filesystem within a single large file. See <a class="reference external" href="system.html#CREATEFS">Example
17-8</a> and <a class="reference external" href="system.html#ISOMOUNTREF">Example
17-7</a>.</p>
<p>A few of the pseudo-devices in <tt class="docutils literal">/dev</tt> have other specialized uses,
such as <tt class="docutils literal">`/dev/null</tt> &lt;zeros.html#ZEROSREF&gt;`_,
<tt class="docutils literal">`/dev/zero</tt> &lt;zeros.html#ZEROSREF1&gt;`_,
<tt class="docutils literal">`/dev/urandom</tt> &lt;randomvar.html#URANDOMREF&gt;`_, <tt class="docutils literal">/dev/sda1</tt> (hard
drive partition), <tt class="docutils literal">/dev/udp</tt> (<em>User Datagram Packet</em> port), and
<tt class="docutils literal">`/dev/tcp</tt> &lt;devref1.html#DEVTCP&gt;`_.</p>
<p>For instance:</p>
<p>To manually <a class="reference external" href="system.html#MOUNTREF">mount</a> a USB flash drive, append
the following line to <tt class="docutils literal">`/etc/fstab</tt> &lt;system.html#FSTABREF&gt;`_.
<a class="reference external" href="devref1.html#FTN.AEN18956">[3]</a></p>
<pre class="literal-block">
/dev/sda1    /mnt/flashdrive    auto    noauto,user,noatime    0 0
</pre>
<p>(See also <a class="reference external" href="contributed-scripts.html#USBINST">Example A-23</a>.)</p>
<p>Checking whether a disk is in the CD-burner (soft-linked to
<tt class="docutils literal">/dev/hdc</tt>):</p>
<pre class="literal-block">
head -1 /dev/hdc


#  head: cannot open '/dev/hdc' for reading: No medium found
#  (No disc in the drive.)

#  head: error reading '/dev/hdc': Input/output error
#  (There is a disk in the drive, but it can't be read;
#+  possibly it's an unrecorded CDR blank.)

#  Stream of characters and assorted gibberish
#  (There is a pre-recorded disk in the drive,
#+ and this is raw output -- a stream of ASCII and binary data.)
#  Here we see the wisdom of using 'head' to limit the output
#+ to manageable proportions, rather than 'cat' or something similar.


#  Now, it's just a matter of checking/parsing the output and taking
#+ appropriate action.
</pre>
<p>When executing a command on a <tt class="docutils literal"><span class="pre">/dev/tcp/$host/$port</span></tt> pseudo-device
file, Bash opens a TCP connection to the associated <em>socket</em>.</p>
<p>A <em>socket</em> is a communications node associated with a specific I/O port.
(This is analogous to a <em>hardware socket</em>, or <em>receptacle</em>, for a
connecting cable.) It permits data transfer between hardware devices on
the same machine, between machines on the same network, between machines
across different networks, and, of course, between machines at different
locations on the Internet.</p>
<p>The following examples assume an active Internet connection.</p>
<p>Getting the time from <tt class="docutils literal">nist.gov</tt>:</p>
<pre class="literal-block">
bash$ cat &lt;/dev/tcp/time.nist.gov/13
53082 04-03-18 04:26:54 68 0 0 502.3 UTC(NIST) *
</pre>
<p>[Mark contributed this example.]</p>
<p>Generalizing the above into a script:</p>
<pre class="literal-block">
#!/bin/bash
# This script must run with root permissions.

URL=&quot;time.nist.gov/13&quot;

Time=$(cat &lt;/dev/tcp/&quot;$URL&quot;)
UTC=$(echo &quot;$Time&quot; | awk '{print$3}')   # Third field is UTC (GMT) time.
# Exercise: modify this for different time zones.

echo &quot;UTC Time = &quot;$UTC&quot;&quot;
</pre>
<p>Downloading a URL:</p>
<pre class="literal-block">
bash$ exec 5&lt;&gt;/dev/tcp/www.net.cn/80
bash$ echo -e &quot;GET / HTTP/1.0\n&quot; &gt;&amp;5
bash$ cat &lt;&amp;5
</pre>
<p>[Thanks, Mark and Mihai Maties.]</p>
<p><strong>Example 29-1. Using ``/dev/tcp`` for troubleshooting</strong></p>
<pre class="literal-block">
#!/bin/bash
# dev-tcp.sh: /dev/tcp redirection to check Internet connection.

# Script by Troy Engel.
# Used with permission.

TCP_HOST=news-15.net       # A known spam-friendly ISP.
TCP_PORT=80                # Port 80 is http.

# Try to connect. (Somewhat similar to a 'ping' . . .)
echo &quot;HEAD / HTTP/1.0&quot; &gt;/dev/tcp/${TCP_HOST}/${TCP_PORT}
MYEXIT=$?

: &lt;&lt;EXPLANATION
If bash was compiled with --enable-net-redirections, it has the capability of
using a special character device for both TCP and UDP redirections. These
redirections are used identically as STDIN/STDOUT/STDERR. The device entries
are 30,36 for /dev/tcp:

  mknod /dev/tcp c 30 36

&gt;From the bash reference:
/dev/tcp/host/port
    If host is a valid hostname or Internet address, and port is an integer
port number or service name, Bash attempts to open a TCP connection to the
corresponding socket.
EXPLANATION


if [ &quot;X$MYEXIT&quot; = &quot;X0&quot; ]; then
  echo &quot;Connection successful. Exit code: $MYEXIT&quot;
else
  echo &quot;Connection unsuccessful. Exit code: $MYEXIT&quot;
fi

exit $MYEXIT
</pre>
<p><strong>Example 29-2. Playing music</strong></p>
<pre class="literal-block">
#!/bin/bash
# music.sh

# MUSIC WITHOUT EXTERNAL FILES

# Author: Antonio Macchi
# Used in ABS Guide with permission


#  /dev/dsp default = 8000 frames per second, 8 bits per frame (1 byte),
#+ 1 channel (mono)

duration=2000       # If 8000 bytes = 1 second, then 2000 = 1/4 second.
volume=$'\xc0'      # Max volume = \xff (or \x00).
mute=$'\x80'        # No volume = \x80 (the middle).

function mknote ()  # $1=Note Hz in bytes (e.g. A = 440Hz ::
{                   #+ 8000 fps / 440 = 16 :: A = 16 bytes per second)
  for t in `seq 0 $duration`
  do
    test $(( $t % $1 )) = 0 &amp;&amp; echo -n $volume || echo -n $mute
  done
}

e=`mknote 49`
g=`mknote 41`
a=`mknote 36`
b=`mknote 32`
c=`mknote 30`
cis=`mknote 29`
d=`mknote 27`
e2=`mknote 24`
n=`mknote 32767`
# European notation.

echo -n &quot;$g$e2$d$c$d$c$a$g$n$g$e$n$g$e2$d$c$c$b$c$cis$n$cis$d \
$n$g$e2$d$c$d$c$a$g$n$g$e$n$g$a$d$c$b$a$b$c&quot; &gt; /dev/dsp
# dsp = Digital Signal Processor

exit      # A &quot;bonny&quot; example of a shell script!
</pre>
<div class="section" id="notes">
<h2>Notes</h2>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">rst-ca/devref1.ca.rst</tt>, line 10); <em><a href="#id4">backlink</a></em></p>
Duplicate explicit target name: &quot;[1]&quot;.</div>
<p><a class="reference external" href="devref1.html#AEN18908">[1]</a></p>
<p>The entries in <tt class="docutils literal">/dev</tt> provide mount points for physical and virtual
devices. These entries use very little drive space.</p>
<p>Some devices, such as <tt class="docutils literal">/dev/null</tt>, <tt class="docutils literal">/dev/zero</tt>, and <tt class="docutils literal">/dev/urandom</tt>
are virtual. They are not actual physical devices and exist only in
software.</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">rst-ca/devref1.ca.rst</tt>, line 10); <em><a href="#id5">backlink</a></em></p>
Duplicate explicit target name: &quot;[2]&quot;.</div>
<p><a class="reference external" href="devref1.html#AEN18928">[2]</a></p>
<p>A <em>block device</em> reads and/or writes data in chunks, or <em>blocks</em>, in
contrast to a <em>character device</em>, which acesses data in <em>character</em>
units. Examples of block devices are hard drives, CDROM drives, and
flash drives. Examples of character devices are keyboards, modems, sound
cards.</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">rst-ca/devref1.ca.rst</tt>, line 10); <em><a href="#id6">backlink</a></em></p>
Duplicate explicit target name: &quot;[3]&quot;.</div>
<p><a class="reference external" href="devref1.html#AEN18956">[3]</a></p>
<p>Of course, the mount point <tt class="docutils literal">/mnt/flashdrive</tt> must exist. If not, then,
as <em>root</em>, <strong>mkdir /mnt/flashdrive</strong>.</p>
<p>To actually mount the drive, use the following command: <strong>mount
/mnt/flashdrive</strong></p>
<p>Newer Linux distros automount flash drives in the <tt class="docutils literal">/media</tt> directory
without user intervention.</p>
<hr class="docutils" />
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="31%" />
<col width="35%" />
</colgroup>
<tbody valign="top">
<tr><td><a class="reference external" href="devproc.html">Prev</a></td>
<td><a class="reference external" href="index.html">Home</a></td>
<td><a class="reference external" href="procref1.html">Next</a></td>
</tr>
<tr><td><tt class="docutils literal">/dev</tt> and <tt class="docutils literal">/proc</tt></td>
<td><a class="reference external" href="devproc.html">Up</a></td>
<td><tt class="docutils literal">/proc</tt></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
