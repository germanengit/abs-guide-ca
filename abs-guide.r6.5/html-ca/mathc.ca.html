<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.8.1: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7056 2011-06-17 10:50:48Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">rst-ca/mathc.ca.rst</tt>, line 1)</p>
<p>Malformed table.</p>
<pre class="literal-block">
+----------------------------------+-------------------------------------------------------+--------------------------+
| Advanced Bash-Scripting Guide:   |
+==================================+=======================================================+==========================+
| `Prev &lt;terminalccmds.html&gt;`_     | Chapter 16. External Filters, Programs and Commands   | `Next &lt;extmisc.html&gt;`_   |
+----------------------------------+-------------------------------------------------------+--------------------------+
</pre>
</div>
<hr class="docutils" />
<div class="section" id="math-commands">
<h1>16.8. Math Commands</h1>
<p><strong>&quot;Doing the numbers&quot;</strong></p>
<dl class="docutils">
<dt><strong>factor</strong></dt>
<dd><p class="first">Decompose an integer into prime factors.</p>
<pre class="literal-block">
bash$ factor 27417
27417: 3 13 19 37
</pre>
<p><strong>Example 16-46. Generating prime numbers</strong></p>
<pre class="last literal-block">
#!/bin/bash
# primes2.sh

#  Generating prime numbers the quick-and-easy way,
#+ without resorting to fancy algorithms.

CEILING=10000   # 1 to 10000
PRIME=0
E_NOTPRIME=

is_prime ()
{
  local factors
  factors=( $(factor $1) )  # Load output of `factor` into array.

if [ -z &quot;${factors[2]}&quot; ]
#  Third element of &quot;factors&quot; array:
#+ ${factors[2]} is 2nd factor of argument.
#  If it is blank, then there is no 2nd factor,
#+ and the argument is therefore prime.
then
  return $PRIME             # 0
else
  return $E_NOTPRIME        # null
fi
}

echo
for n in $(seq $CEILING)
do
  if is_prime $n
  then
    printf %5d $n
  fi   #    ^  Five positions per number suffices.
done   #       For a higher $CEILING, adjust upward, as necessary.

echo

exit
</pre>
</dd>
<dt><strong>bc</strong></dt>
<dd><p class="first">Bash can't handle floating point calculations, and it lacks
operators for certain important mathematical functions. Fortunately,
<strong>bc</strong> gallops to the rescue.</p>
<p>Not just a versatile, arbitrary precision calculation utility,
<strong>bc</strong> offers many of the facilities of a programming language. It
has a syntax vaguely resembling <strong>C</strong>.</p>
<p>Since it is a fairly well-behaved UNIX utility, and may therefore be
used in a <a class="reference external" href="special-chars.html#PIPEREF">pipe</a>, <strong>bc</strong> comes in
handy in scripts.</p>
<p>Here is a simple template for using <strong>bc</strong> to calculate a script
variable. This uses <a class="reference external" href="commandsub.html#COMMANDSUBREF">command
substitution</a>.</p>
<pre class="literal-block">
variable=$(echo &quot;OPTIONS; OPERATIONS&quot; | bc)
</pre>
<p><strong>Example 16-47. Monthly Payment on a Mortgage</strong></p>
<pre class="literal-block">
#!/bin/bash
# monthlypmt.sh: Calculates monthly payment on a mortgage.


#  This is a modification of code in the
#+ &quot;mcalc&quot; (mortgage calculator) package,
#+ by Jeff Schmidt
#+ and
#+ Mendel Cooper (yours truly, the ABS Guide author).
#   http://www.ibiblio.org/pub/Linux/apps/financial/mcalc-1.6.tar.gz

echo
echo &quot;Given the principal, interest rate, and term of a mortgage,&quot;
echo &quot;calculate the monthly payment.&quot;

bottom=1.0

echo
echo -n &quot;Enter principal (no commas) &quot;
read principal
echo -n &quot;Enter interest rate (percent) &quot;  # If 12%, enter &quot;12&quot;, not &quot;.12&quot;.
read interest_r
echo -n &quot;Enter term (months) &quot;
read term


 interest_r=$(echo &quot;scale=9; $interest_r/100.0&quot; | bc) # Convert to decimal.
                 #           ^^^^^^^^^^^^^^^^^  Divide by 100.
                 # &quot;scale&quot; determines how many decimal places.

 interest_rate=$(echo &quot;scale=9; $interest_r/12 + 1.0&quot; | bc)


 top=$(echo &quot;scale=9; $principal*$interest_rate^$term&quot; | bc)
          #           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
          #           Standard formula for figuring interest.

 echo; echo &quot;Please be patient. This may take a while.&quot;

 let &quot;months = $term - 1&quot;
# ====================================================================
 for ((x=$months; x &gt; 0; x--))
 do
   bot=$(echo &quot;scale=9; $interest_rate^$x&quot; | bc)
   bottom=$(echo &quot;scale=9; $bottom+$bot&quot; | bc)
#  bottom = $(($bottom + $bot&quot;))
 done
# ====================================================================

# --------------------------------------------------------------------
#  Rick Boivie pointed out a more efficient implementation
#+ of the above loop, which decreases computation time by 2/3.

# for ((x=1; x &lt;= $months; x++))
# do
#   bottom=$(echo &quot;scale=9; $bottom * $interest_rate + 1&quot; | bc)
# done


#  And then he came up with an even more efficient alternative,
#+ one that cuts down the run time by about 95%!

# bottom=`{
#     echo &quot;scale=9; bottom=$bottom; interest_rate=$interest_rate&quot;
#     for ((x=1; x &lt;= $months; x++))
#     do
#          echo 'bottom = bottom * interest_rate + 1'
#     done
#     echo 'bottom'
#     } | bc`       # Embeds a 'for loop' within command substitution.
# --------------------------------------------------------------------------
#  On the other hand, Frank Wang suggests:
#  bottom=$(echo &quot;scale=9; ($interest_rate^$term-1)/($interest_rate-1)&quot; | bc)

#  Because . . .
#  The algorithm behind the loop
#+ is actually a sum of geometric proportion series.
#  The sum formula is e0(1-q^n)/(1-q),
#+ where e0 is the first element and q=e(n+1)/e(n)
#+ and n is the number of elements.
# --------------------------------------------------------------------------


 # let &quot;payment = $top/$bottom&quot;
 payment=$(echo &quot;scale=2; $top/$bottom&quot; | bc)
 # Use two decimal places for dollars and cents.

 echo
 echo &quot;monthly payment = \$$payment&quot;  # Echo a dollar sign in front of amount.
 echo


 exit 0


 # Exercises:
 #   1) Filter input to permit commas in principal amount.
 #   2) Filter input to permit interest to be entered as percent or decimal.
 #   3) If you are really ambitious,
 #+     expand this script to print complete amortization tables.
</pre>
<p><strong>Example 16-48. Base Conversion</strong></p>
<pre class="literal-block">
#!/bin/bash
###########################################################################
# Shellscript:  base.sh - print number to different bases (Bourne Shell)
# Author     :  Heiner Steven (heiner.steven&#64;odn.de)
# Date       :  07-03-95
# Category   :  Desktop
# $Id: base.sh,v 1.2 2000/02/06 19:55:35 heiner Exp $
# ==&gt; Above line is RCS ID info.
###########################################################################
# Description
#
# Changes
# 21-03-95 stv  fixed error occuring with 0xb as input (0.2)
###########################################################################

# ==&gt; Used in ABS Guide with the script author's permission.
# ==&gt; Comments added by ABS Guide author.

NOARGS=85
PN=`basename &quot;$0&quot;`                 # Program name
VER=`echo '$Revision: 1.2 $' | cut -d' ' -f2`  # ==&gt; VER=1.2

Usage () {
    echo &quot;$PN - print number to different bases, $VER (stv '95)
usage: $PN [number ...]

If no number is given, the numbers are read from standard input.
A number may be
    binary (base 2)     starting with 0b (i.e. 0b1100)
    octal (base 8)      starting with 0  (i.e. 014)
    hexadecimal (base 16)   starting with 0x (i.e. 0xc)
    decimal         otherwise (i.e. 12)&quot; &gt;&amp;2
    exit $NOARGS
}   # ==&gt; Prints usage message.

Msg () {
    for i   # ==&gt; in [list] missing. Why?
    do echo &quot;$PN: $i&quot; &gt;&amp;2
    done
}

Fatal () { Msg &quot;$&#64;&quot;; exit 66; }

PrintBases () {
    # Determine base of the number
    for i      # ==&gt; in [list] missing...
    do         # ==&gt; so operates on command-line arg(s).
    case &quot;$i&quot; in
        0b*)        ibase=2;;   # binary
        0x*|[a-f]*|[A-F]*)  ibase=16;;  # hexadecimal
        0*)         ibase=8;;   # octal
        [1-9]*)     ibase=10;;  # decimal
        *)
        Msg &quot;illegal number $i - ignored&quot;
        continue;;
    esac

    # Remove prefix, convert hex digits to uppercase (bc needs this).
    number=`echo &quot;$i&quot; | sed -e 's:^0[bBxX]::' | tr '[a-f]' '[A-F]'`
    # ==&gt; Uses &quot;:&quot; as sed separator, rather than &quot;/&quot;.

    # Convert number to decimal
    dec=`echo &quot;ibase=$ibase; $number&quot; | bc`  # ==&gt; 'bc' is calculator utility.
    case &quot;$dec&quot; in
        [0-9]*) ;;           # number ok
        *)      continue;;       # error: ignore
    esac

    # Print all conversions in one line.
    # ==&gt; 'here document' feeds command list to 'bc'.
    echo `bc &lt;&lt;!
        obase=16; &quot;hex=&quot;; $dec
        obase=10; &quot;dec=&quot;; $dec
        obase=8;  &quot;oct=&quot;; $dec
        obase=2;  &quot;bin=&quot;; $dec
!
    ` | sed -e 's: :    :g'

    done
}

while [ $# -gt 0 ]
# ==&gt;  Is a &quot;while loop&quot; really necessary here,
# ==&gt;+ since all the cases either break out of the loop
# ==&gt;+ or terminate the script.
# ==&gt; (Above comment by Paulo Marcel Coelho Aragao.)
do
    case &quot;$1&quot; in
    --)     shift; break;;
    -h)     Usage;;                 # ==&gt; Help message.
    -*)     Usage;;
         *)     break;;                 # First number
    esac   # ==&gt; Error checking for illegal input might be appropriate.
    shift
done

if [ $# -gt 0 ]
then
    PrintBases &quot;$&#64;&quot;
else                    # Read from stdin.
    while read line
    do
    PrintBases $line
    done
fi


exit
</pre>
<p>An alternate method of invoking <strong>bc</strong> involves using a <a class="reference external" href="here-docs.html#HEREDOCREF">here
document</a> embedded within a <a class="reference external" href="commandsub.html#COMMANDSUBREF">command
substitution</a> block. This is
especially appropriate when a script needs to pass a list of options
and commands to <strong>bc</strong>.</p>
<pre class="literal-block">
variable=`bc &lt;&lt; LIMIT_STRING
options
statements
operations
LIMIT_STRING
`

...or...


variable=$(bc &lt;&lt; LIMIT_STRING
options
statements
operations
LIMIT_STRING
)
</pre>
<p><strong>Example 16-49. Invoking *bc* using a *here document*</strong></p>
<pre class="literal-block">
#!/bin/bash
# Invoking 'bc' using command substitution
# in combination with a 'here document'.


var1=`bc &lt;&lt; EOF
18.33 * 19.78
EOF
`
echo $var1       # 362.56


#  $( ... ) notation also works.
v1=23.53
v2=17.881
v3=83.501
v4=171.63

var2=$(bc &lt;&lt; EOF
scale = 4
a = ( $v1 + $v2 )
b = ( $v3 * $v4 )
a * b + 15.35
EOF
)
echo $var2       # 593487.8452


var3=$(bc -l &lt;&lt; EOF
scale = 9
s ( 1.7 )
EOF
)
# Returns the sine of 1.7 radians.
# The &quot;-l&quot; option calls the 'bc' math library.
echo $var3       # .991664810


# Now, try it in a function...
hypotenuse ()    # Calculate hypotenuse of a right triangle.
{                # c = sqrt( a^2 + b^2 )
hyp=$(bc -l &lt;&lt; EOF
scale = 9
sqrt ( $1 * $1 + $2 * $2 )
EOF
)
# Can't directly return floating point values from a Bash function.
# But, can echo-and-capture:
echo &quot;$hyp&quot;
}

hyp=$(hypotenuse 3.68 7.31)
echo &quot;hypotenuse = $hyp&quot;    # 8.184039344


exit 0
</pre>
<p><strong>Example 16-50. Calculating PI</strong></p>
<pre class="literal-block">
#!/bin/bash
# cannon.sh: Approximating PI by firing cannonballs.

# Author: Mendel Cooper
# License: Public Domain
# Version 2.2, reldate 13oct08.

# This is a very simple instance of a &quot;Monte Carlo&quot; simulation:
#+ a mathematical model of a real-life event,
#+ using pseudorandom numbers to emulate random chance.

#  Consider a perfectly square plot of land, 10000 units on a side.
#  This land has a perfectly circular lake in its center,
#+ with a diameter of 10000 units.
#  The plot is actually mostly water, except for land in the four corners.
#  (Think of it as a square with an inscribed circle.)
#
#  We will fire iron cannonballs from an old-style cannon
#+ at the square.
#  All the shots impact somewhere on the square,
#+ either in the lake or on the dry corners.
#  Since the lake takes up most of the area,
#+ most of the shots will SPLASH! into the water.
#  Just a few shots will THUD! into solid ground
#+ in the four corners of the square.
#
#  If we take enough random, unaimed shots at the square,
#+ Then the ratio of SPLASHES to total shots will approximate
#+ the value of PI/4.
#
#  The simplified explanation is that the cannon is actually
#+ shooting only at the upper right-hand quadrant of the square,
#+ i.e., Quadrant I of the Cartesian coordinate plane.
#
#
#  Theoretically, the more shots taken, the better the fit.
#  However, a shell script, as opposed to a compiled language
#+ with floating-point math built in, requires some compromises.
#  This decreases the accuracy of the simulation.


DIMENSION=10000  # Length of each side of the plot.
                 # Also sets ceiling for random integers generated.

MAXSHOTS=1000    # Fire this many shots.
                 # 10000 or more would be better, but would take too long.
PMULTIPLIER=4.0  # Scaling factor.

declare -r M_PI=3.141592654
                 # Actual 9-place value of PI, for comparison purposes.

get_random ()
{
SEED=$(head -n 1 /dev/urandom | od -N 1 | awk '{ print $2 }')
RANDOM=$SEED                                  #  From &quot;seeding-random.sh&quot;
                                              #+ example script.
let &quot;rnum = $RANDOM % $DIMENSION&quot;             #  Range less than 10000.
echo $rnum
}

distance=        # Declare global variable.
hypotenuse ()    # Calculate hypotenuse of a right triangle.
{                # From &quot;alt-bc.sh&quot; example.
distance=$(bc -l &lt;&lt; EOF
scale = 0
sqrt ( $1 * $1 + $2 * $2 )
EOF
)
#  Setting &quot;scale&quot; to zero rounds down result to integer value,
#+ a necessary compromise in this script.
#  It decreases the accuracy of this simulation.
}


# ==========================================================
# main() {
# &quot;Main&quot; code block, mimicking a C-language main() function.

# Initialize variables.
shots=0
splashes=0
thuds=0
Pi=0
error=0

while [ &quot;$shots&quot; -lt  &quot;$MAXSHOTS&quot; ]           # Main loop.
do

  xCoord=$(get_random)                        # Get random X and Y coords.
  yCoord=$(get_random)
  hypotenuse $xCoord $yCoord                  #  Hypotenuse of
                                              #+ right-triangle = distance.
  ((shots++))

  printf &quot;#%4d   &quot; $shots
  printf &quot;Xc = %4d  &quot; $xCoord
  printf &quot;Yc = %4d  &quot; $yCoord
  printf &quot;Distance = %5d  &quot; $distance         #   Distance from
                                              #+  center of lake
                                              #+  -- the &quot;origin&quot; --
                                              #+  coordinate (0,0).

  if [ &quot;$distance&quot; -le &quot;$DIMENSION&quot; ]
  then
    echo -n &quot;SPLASH!  &quot;
    ((splashes++))
  else
    echo -n &quot;THUD!    &quot;
    ((thuds++))
  fi

  Pi=$(echo &quot;scale=9; $PMULTIPLIER*$splashes/$shots&quot; | bc)
  # Multiply ratio by 4.0.
  echo -n &quot;PI ~ $Pi&quot;
  echo

done

echo
echo &quot;After $shots shots, PI looks like approximately   $Pi&quot;
#  Tends to run a bit high,
#+ possibly due to round-off error and imperfect randomness of $RANDOM.
#  But still usually within plus-or-minus 5% . . .
#+ a pretty fair rough approximation.
error=$(echo &quot;scale=9; $Pi - $M_PI&quot; | bc)
pct_error=$(echo &quot;scale=2; 100.0 * $error / $M_PI&quot; | bc)
echo -n &quot;Deviation from mathematical value of PI =        $error&quot;
echo &quot; ($pct_error% error)&quot;
echo

# End of &quot;main&quot; code block.
# }
# ==========================================================

exit 0

#  One might well wonder whether a shell script is appropriate for
#+ an application as complex and computation-intensive as a simulation.
#
#  There are at least two justifications.
#  1) As a proof of concept: to show it can be done.
#  2) To prototype and test the algorithms before rewriting
#+    it in a compiled high-level language.
</pre>
<p class="last">See also <a class="reference external" href="contributed-scripts.html#STDDEV">Example A-37</a>.</p>
</dd>
<dt><strong>dc</strong></dt>
<dd><p class="first">The <strong>dc</strong> (<strong>d**esk **c**alculator) utility is
`stack-oriented &lt;internalvariables.html#STACKDEFREF&gt;`_ and uses RPN
(*Reverse Polish Notation*). Like **bc</strong>, it has much of the power
of a programming language.</p>
<p>Similar to the procedure with <strong>bc</strong>,
<a class="reference external" href="internal.html#ECHOREF">echo</a> a command-string to <strong>dc</strong>.</p>
<pre class="literal-block">
echo &quot;[Printing a string ... ]P&quot; | dc
# The P command prints the string between the preceding brackets.

# And now for some simple arithmetic.
echo &quot;7 8 * p&quot; | dc     # 56
#  Pushes 7, then 8 onto the stack,
#+ multiplies (&quot;*&quot; operator), then prints the result (&quot;p&quot; operator).
</pre>
<p>Most persons avoid <strong>dc</strong>, because of its non-intuitive input and
rather cryptic operators. Yet, it has its uses.</p>
<p><strong>Example 16-51. Converting a decimal number to hexadecimal</strong></p>
<pre class="literal-block">
#!/bin/bash
# hexconvert.sh: Convert a decimal number to hexadecimal.

E_NOARGS=85 # Command-line arg missing.
BASE=16     # Hexadecimal.

if [ -z &quot;$1&quot; ]
then        # Need a command-line argument.
  echo &quot;Usage: $0 number&quot;
  exit $E_NOARGS
fi          # Exercise: add argument validity checking.


hexcvt ()
{
if [ -z &quot;$1&quot; ]
then
  echo 0
  return    # &quot;Return&quot; 0 if no arg passed to function.
fi

echo &quot;&quot;$1&quot; &quot;$BASE&quot; o p&quot; | dc
#                  o    sets radix (numerical base) of output.
#                    p  prints the top of stack.
# For other options: 'man dc' ...
return
}

hexcvt &quot;$1&quot;

exit
</pre>
<p>Studying the <a class="reference external" href="basic.html#INFOREF">info</a> page for <strong>dc</strong> is a
painful path to understanding its intricacies. There seems to be a
small, select group of <em>dc wizards</em> who delight in showing off their
mastery of this powerful, but arcane utility.</p>
<pre class="literal-block">
bash$ echo &quot;16i[q]sa[ln0=aln100%Pln100/snlbx]sbA0D68736142snlbxq&quot; | dc
Bash
</pre>
<pre class="literal-block">
dc &lt;&lt;&lt; 10k5v1+2/p # 1.6180339887
#  ^^^            Feed operations to dc using a Here String.
#      ^^^        Pushes 10 and sets that as the precision (10k).
#         ^^      Pushes 5 and takes its square root
#                 (5v, v = square root).
#           ^^    Pushes 1 and adds it to the running total (1+).
#             ^^  Pushes 2 and divides the running total by that (2/).
#               ^ Pops and prints the result (p)
#  The result is  1.6180339887 ...
#  ... which happens to be the Pythagorean Golden Ratio, to 10 places.
</pre>
<p><strong>Example 16-52. Factoring</strong></p>
<pre class="last literal-block">
#!/bin/bash
# factr.sh: Factor a number

MIN=2       # Will not work for number smaller than this.
E_NOARGS=85
E_TOOSMALL=86

if [ -z $1 ]
then
  echo &quot;Usage: $0 number&quot;
  exit $E_NOARGS
fi

if [ &quot;$1&quot; -lt &quot;$MIN&quot; ]
then
  echo &quot;Number to factor must be $MIN or greater.&quot;
  exit $E_TOOSMALL
fi

# Exercise: Add type checking (to reject non-integer arg).

echo &quot;Factors of $1:&quot;
# -------------------------------------------------------
echo  &quot;$1[p]s2[lip/dli%0=1dvsr]s12sid2%0=13sidvsr[dli%0=\
1lrli2+dsi!&gt;.]ds.xd1&lt;2&quot; | dc
# -------------------------------------------------------
#  Above code written by Michel Charpentier &lt;charpov&#64;cs.unh.edu&gt;
#  (as a one-liner, here broken into two lines for display purposes).
#  Used in ABS Guide with permission (thanks!).

 exit

 # $ sh factr.sh 270138
 # 2
 # 3
 # 11
 # 4093
</pre>
</dd>
<dt><strong>awk</strong></dt>
<dd><p class="first">Yet another way of doing floating point math in a script is using
<a class="reference external" href="awk.html#AWKREF">awk's</a> built-in math functions in a <a class="reference external" href="wrapper.html#SHWRAPPER">shell
wrapper</a>.</p>
<p><strong>Example 16-53. Calculating the hypotenuse of a triangle</strong></p>
<pre class="last literal-block">
#!/bin/bash
# hypotenuse.sh: Returns the &quot;hypotenuse&quot; of a right triangle.
#                (square root of sum of squares of the &quot;legs&quot;)

ARGS=2                # Script needs sides of triangle passed.
E_BADARGS=85          # Wrong number of arguments.

if [ $# -ne &quot;$ARGS&quot; ] # Test number of arguments to script.
then
  echo &quot;Usage: `basename $0` side_1 side_2&quot;
  exit $E_BADARGS
fi


AWKSCRIPT=' { printf( &quot;%3.7f\n&quot;, sqrt($1*$1 + $2*$2) ) } '
#             command(s) / parameters passed to awk


# Now, pipe the parameters to awk.
    echo -n &quot;Hypotenuse of $1 and $2 = &quot;
    echo $1 $2 | awk &quot;$AWKSCRIPT&quot;
#   ^^^^^^^^^^^^
# An echo-and-pipe is an easy way of passing shell parameters to awk.

exit

# Exercise: Rewrite this script using 'bc' rather than awk.
#           Which method is more intuitive?
</pre>
</dd>
</dl>
<hr class="docutils" />
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="30%" />
<col width="31%" />
</colgroup>
<tbody valign="top">
<tr><td><a class="reference external" href="terminalccmds.html">Prev</a></td>
<td><a class="reference external" href="index.html">Home</a></td>
<td><a class="reference external" href="extmisc.html">Next</a></td>
</tr>
<tr><td>Terminal Control Commands</td>
<td><a class="reference external" href="external.html">Up</a></td>
<td>Miscellaneous Commands</td>
</tr>
</tbody>
</table>
</div>
</div>
</body>
</html>
