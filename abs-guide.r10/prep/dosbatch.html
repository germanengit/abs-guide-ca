<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
 <head>
  <title>
   Converting DOS Batch Files to Shell Scripts
  </title>
  <meta content="Modular DocBook HTML Stylesheet Version 1.7" name="GENERATOR"/>
  <link href="index.html" rel="HOME" title="Advanced Bash-Scripting Guide"/>
  <link href="sample-bashrc.html" rel="PREVIOUS" title="Sample .bashrc  and
	    .bash_profile Files"/>
  <link href="exercises.html" rel="NEXT" title="Exercises"/>
 </head>
 <body alink="#0000FF" bgcolor="#FFFFFF" class="APPENDIX" link="#0000FF" text="#000000" vlink="#840084">
  <div class="APPENDIX">
   <h1>
    <a name="DOSBATCH">
    </a>
    Appendix N. Converting DOS Batch Files to Shell Scripts
   </h1>
   <p>
    <a name="DOSBATCH1">
    </a>
   </p>
   <p>
    Quite a number of programmers learned scripting on a PC running
    DOS. Even the crippled DOS batch file language allowed writing some
    fairly powerful scripts and applications, though they often required
    extensive kludges and workarounds. Occasionally, the need still
    arises to convert an old DOS batch file to a UNIX shell script. This
    is generally not difficult, as DOS batch file operators are only a
    limited subset of the equivalent shell scripting ones.
   </p>
   <div class="TABLE">
    <a name="AEN24336">
    </a>
    <p>
     <b>
      Table N-1. Batch file keywords / variables / operators, and their shell equivalents
     </b>
    </p>
    <div>
     <p>
      Batch File Operator
     </p>
     <p>
      Shell Script Equivalent
     </p>
     <p>
      Meaning
     </p>
     <p>
      <tt class="OPTION">
       %
      </tt>
     </p>
     <p>
      $
     </p>
     <p>
      command-line parameter prefix
     </p>
     <p>
      <tt class="OPTION">
       /
      </tt>
     </p>
     <p>
      -
     </p>
     <p>
      command option flag
     </p>
     <p>
      <tt class="OPTION">
       \
      </tt>
     </p>
     <p>
      /
     </p>
     <p>
      directory path separator
     </p>
     <p>
      <tt class="OPTION">
       ==
      </tt>
     </p>
     <p>
      =
     </p>
     <p>
      (equal-to) string comparison test
     </p>
     <p>
      <tt class="OPTION">
       !==!
      </tt>
     </p>
     <p>
      !=
     </p>
     <p>
      (not equal-to) string comparison test
     </p>
     <p>
      <tt class="OPTION">
       |
      </tt>
     </p>
     <p>
      |
     </p>
     <p>
      pipe
     </p>
     <p>
      <tt class="OPTION">
       @
      </tt>
     </p>
     <p>
      set
      <tt class="OPTION">
       +v
      </tt>
     </p>
     <p>
      do not echo current command
     </p>
     <p>
      <tt class="OPTION">
       *
      </tt>
     </p>
     <p>
      *
     </p>
     <p>
      filename
      <span class="QUOTE">
       "wild card"
      </span>
     </p>
     <p>
      <tt class="OPTION">
       &gt;
      </tt>
     </p>
     <p>
      &gt;
     </p>
     <p>
      file redirection (overwrite)
     </p>
     <p>
      <tt class="OPTION">
       &gt;&gt;
      </tt>
     </p>
     <p>
      &gt;&gt;
     </p>
     <p>
      file redirection (append)
     </p>
     <p>
      <tt class="OPTION">
       &lt;
      </tt>
     </p>
     <p>
      &lt;
     </p>
     <p>
      redirect
      <tt class="FILENAME">
       stdin
      </tt>
     </p>
     <p>
      <tt class="OPTION">
       %VAR%
      </tt>
     </p>
     <p>
      $VAR
     </p>
     <p>
      environmental variable
     </p>
     <p>
      <tt class="OPTION">
       REM
      </tt>
     </p>
     <p>
      #
     </p>
     <p>
      comment
     </p>
     <p>
      <tt class="OPTION">
       NOT
      </tt>
     </p>
     <p>
      !
     </p>
     <p>
      negate following test
     </p>
     <p>
      <tt class="OPTION">
       NUL
      </tt>
     </p>
     <p>
      <tt class="FILENAME">
       /dev/null
      </tt>
     </p>
     <p>
      <span class="QUOTE">
       "black hole"
      </span>
      for burying command output
     </p>
     <p>
      <tt class="OPTION">
       ECHO
      </tt>
     </p>
     <p>
      echo
     </p>
     <p>
      echo (many more option in Bash)
     </p>
     <p>
      <tt class="OPTION">
       ECHO.
      </tt>
     </p>
     <p>
      echo
     </p>
     <p>
      echo blank line
     </p>
     <p>
      <tt class="OPTION">
       ECHO OFF
      </tt>
     </p>
     <p>
      set
      <tt class="OPTION">
       +v
      </tt>
     </p>
     <p>
      do not echo command(s) following
     </p>
     <p>
      <tt class="OPTION">
       FOR %%VAR IN (LIST) DO
      </tt>
     </p>
     <p>
      for var in [list]; do
     </p>
     <p>
      <span class="QUOTE">
       "for"
      </span>
      loop
     </p>
     <p>
      <tt class="OPTION">
       :LABEL
      </tt>
     </p>
     <p>
      none (unnecessary)
     </p>
     <p>
      label
     </p>
     <p>
      <tt class="OPTION">
       GOTO
      </tt>
     </p>
     <p>
      none (use a function)
     </p>
     <p>
      jump to another location in the script
     </p>
     <p>
      <tt class="OPTION">
       PAUSE
      </tt>
     </p>
     <p>
      sleep
     </p>
     <p>
      pause or wait an interval
     </p>
     <p>
      <tt class="OPTION">
       CHOICE
      </tt>
     </p>
     <p>
      case or select
     </p>
     <p>
      menu choice
     </p>
     <p>
      <tt class="OPTION">
       IF
      </tt>
     </p>
     <p>
      if
     </p>
     <p>
      if-test
     </p>
     <p>
      <tt class="OPTION">
       IF EXIST
       <tt class="REPLACEABLE">
        <i>
         FILENAME
        </i>
       </tt>
      </tt>
     </p>
     <p>
      if [ -e filename ]
     </p>
     <p>
      test if file exists
     </p>
     <p>
      <tt class="OPTION">
       IF !%N==!
      </tt>
     </p>
     <p>
      if [ -z "$N" ]
     </p>
     <p>
      if replaceable parameter
      <span class="QUOTE">
       "N"
      </span>
      not present
     </p>
     <p>
      <tt class="OPTION">
       CALL
      </tt>
     </p>
     <p>
      source or . (dot operator)
     </p>
     <p>
      <span class="QUOTE">
       "include"
      </span>
      another script
     </p>
     <p>
      <tt class="OPTION">
       COMMAND /C
      </tt>
     </p>
     <p>
      source or . (dot operator)
     </p>
     <p>
      <span class="QUOTE">
       "include"
      </span>
      another script (same as
	        CALL)
     </p>
     <p>
      <tt class="OPTION">
       SET
      </tt>
     </p>
     <p>
      export
     </p>
     <p>
      set an environmental variable
     </p>
     <p>
      <tt class="OPTION">
       SHIFT
      </tt>
     </p>
     <p>
      shift
     </p>
     <p>
      left shift command-line argument list
     </p>
     <p>
      <tt class="OPTION">
       SGN
      </tt>
     </p>
     <p>
      -lt or -gt
     </p>
     <p>
      sign (of integer)
     </p>
     <p>
      <tt class="OPTION">
       ERRORLEVEL
      </tt>
     </p>
     <p>
      $?
     </p>
     <p>
      exit status
     </p>
     <p>
      <tt class="OPTION">
       CON
      </tt>
     </p>
     <p>
      <tt class="FILENAME">
       stdin
      </tt>
     </p>
     <p>
      <span class="QUOTE">
       "console"
      </span>
      (
      <tt class="FILENAME">
       stdin
      </tt>
      )
     </p>
     <p>
      <tt class="OPTION">
       PRN
      </tt>
     </p>
     <p>
      <tt class="FILENAME">
       /dev/lp0
      </tt>
     </p>
     <p>
      (generic) printer device
     </p>
     <p>
      <tt class="OPTION">
       LPT1
      </tt>
     </p>
     <p>
      <tt class="FILENAME">
       /dev/lp0
      </tt>
     </p>
     <p>
      first printer device
     </p>
     <p>
      <tt class="OPTION">
       COM1
      </tt>
     </p>
     <p>
      <tt class="FILENAME">
       /dev/ttyS0
      </tt>
     </p>
     <p>
      first serial port
     </p>
    </div>
   </div>
   <p>
    <a name="DOSUNIXEQUIV">
    </a>
   </p>
   <p>
    Batch files usually contain DOS commands. These must be
	translated into their UNIX equivalents in order to convert a
	batch file into a shell script.
   </p>
   <div class="TABLE">
    <a name="AEN24545">
    </a>
    <p>
     <b>
      Table N-2. DOS commands and their UNIX equivalents
     </b>
    </p>
    <div>
     <p>
      DOS Command
     </p>
     <p>
      UNIX Equivalent
     </p>
     <p>
      Effect
     </p>
     <p>
      <tt class="OPTION">
       ASSIGN
      </tt>
     </p>
     <p>
      ln
     </p>
     <p>
      link file or directory
     </p>
     <p>
      <tt class="OPTION">
       ATTRIB
      </tt>
     </p>
     <p>
      chmod
     </p>
     <p>
      change file permissions
     </p>
     <p>
      <tt class="OPTION">
       CD
      </tt>
     </p>
     <p>
      cd
     </p>
     <p>
      change directory
     </p>
     <p>
      <tt class="OPTION">
       CHDIR
      </tt>
     </p>
     <p>
      cd
     </p>
     <p>
      change directory
     </p>
     <p>
      <tt class="OPTION">
       CLS
      </tt>
     </p>
     <p>
      clear
     </p>
     <p>
      clear screen
     </p>
     <p>
      <tt class="OPTION">
       COMP
      </tt>
     </p>
     <p>
      diff, comm, cmp
     </p>
     <p>
      file compare
     </p>
     <p>
      <tt class="OPTION">
       COPY
      </tt>
     </p>
     <p>
      cp
     </p>
     <p>
      file copy
     </p>
     <p>
      <tt class="OPTION">
       Ctl-C
      </tt>
     </p>
     <p>
      Ctl-C
     </p>
     <p>
      break (signal)
     </p>
     <p>
      <tt class="OPTION">
       Ctl-Z
      </tt>
     </p>
     <p>
      Ctl-D
     </p>
     <p>
      EOF (end-of-file)
     </p>
     <p>
      <tt class="OPTION">
       DEL
      </tt>
     </p>
     <p>
      rm
     </p>
     <p>
      delete file(s)
     </p>
     <p>
      <tt class="OPTION">
       DELTREE
      </tt>
     </p>
     <p>
      rm -rf
     </p>
     <p>
      delete directory recursively
     </p>
     <p>
      <tt class="OPTION">
       DIR
      </tt>
     </p>
     <p>
      ls -l
     </p>
     <p>
      directory listing
     </p>
     <p>
      <tt class="OPTION">
       ERASE
      </tt>
     </p>
     <p>
      rm
     </p>
     <p>
      delete file(s)
     </p>
     <p>
      <tt class="OPTION">
       EXIT
      </tt>
     </p>
     <p>
      exit
     </p>
     <p>
      exit current process
     </p>
     <p>
      <tt class="OPTION">
       FC
      </tt>
     </p>
     <p>
      comm, cmp
     </p>
     <p>
      file compare
     </p>
     <p>
      <tt class="OPTION">
       FIND
      </tt>
     </p>
     <p>
      grep
     </p>
     <p>
      find strings in files
     </p>
     <p>
      <tt class="OPTION">
       MD
      </tt>
     </p>
     <p>
      mkdir
     </p>
     <p>
      make directory
     </p>
     <p>
      <tt class="OPTION">
       MKDIR
      </tt>
     </p>
     <p>
      mkdir
     </p>
     <p>
      make directory
     </p>
     <p>
      <tt class="OPTION">
       MORE
      </tt>
     </p>
     <p>
      more
     </p>
     <p>
      text file paging filter
     </p>
     <p>
      <tt class="OPTION">
       MOVE
      </tt>
     </p>
     <p>
      mv
     </p>
     <p>
      move
     </p>
     <p>
      <tt class="OPTION">
       PATH
      </tt>
     </p>
     <p>
      $PATH
     </p>
     <p>
      path to executables
     </p>
     <p>
      <tt class="OPTION">
       REN
      </tt>
     </p>
     <p>
      mv
     </p>
     <p>
      rename (move)
     </p>
     <p>
      <tt class="OPTION">
       RENAME
      </tt>
     </p>
     <p>
      mv
     </p>
     <p>
      rename (move)
     </p>
     <p>
      <tt class="OPTION">
       RD
      </tt>
     </p>
     <p>
      rmdir
     </p>
     <p>
      remove directory
     </p>
     <p>
      <tt class="OPTION">
       RMDIR
      </tt>
     </p>
     <p>
      rmdir
     </p>
     <p>
      remove directory
     </p>
     <p>
      <tt class="OPTION">
       SORT
      </tt>
     </p>
     <p>
      sort
     </p>
     <p>
      sort file
     </p>
     <p>
      <tt class="OPTION">
       TIME
      </tt>
     </p>
     <p>
      date
     </p>
     <p>
      display system time
     </p>
     <p>
      <tt class="OPTION">
       TYPE
      </tt>
     </p>
     <p>
      cat
     </p>
     <p>
      output file to
      <tt class="FILENAME">
       stdout
      </tt>
     </p>
     <p>
      <tt class="OPTION">
       XCOPY
      </tt>
     </p>
     <p>
      cp
     </p>
     <p>
      (extended) file copy
     </p>
    </div>
   </div>
   <div class="NOTE">
    <p>
    </p>
    <div>
     <p>
      <img alt="Note" hspace="5" src="../images/note.gif"/>
     </p>
     <p>
      <p>
       Virtually all UNIX and shell operators and commands have
	many more options and enhancements than their DOS and batch file
	counterparts. Many DOS batch files rely on auxiliary utilities,
	such as
       <b class="COMMAND">
        ask.com
       </b>
       , a crippled counterpart to
       <a href="internal.html#READREF">
        read
       </a>
       .
      </p>
      <p>
       DOS supports only a very limited and incompatible subset of
	filename
       <a href="globbingref.html">
        wild-card expansion
       </a>
       ,
	recognizing just the
       <span class="TOKEN">
        *
       </span>
       and
       <span class="TOKEN">
        ?
       </span>
       characters.
      </p>
     </p>
    </div>
   </div>
   <p>
    Converting a DOS batch file into a shell script is generally
	straightforward, and the result ofttimes reads better than the
	original.
   </p>
   <div class="EXAMPLE">
    <a name="VIEWDAT">
    </a>
    <p>
     <b>
      Example N-1. VIEWDATA.BAT: DOS Batch File
     </b>
    </p>
    <div>
     <p>
      <font color="#000000">
       <pre class="PROGRAMLISTING">REM VIEWDATA

REM INSPIRED BY AN EXAMPLE IN "DOS POWERTOOLS"
REM                           BY PAUL SOMERSON


@ECHO OFF

IF !%1==! GOTO VIEWDATA
REM  IF NO COMMAND-LINE ARG...
FIND "%1" C:\BOZO\BOOKLIST.TXT
GOTO EXIT0
REM  PRINT LINE WITH STRING MATCH, THEN EXIT.

:VIEWDATA
TYPE C:\BOZO\BOOKLIST.TXT | MORE
REM  SHOW ENTIRE FILE, 1 PAGE AT A TIME.

:EXIT0</pre>
      </font>
     </p>
    </div>
   </div>
   <p>
    The script conversion is somewhat of an improvement.
    <a href="dosbatch.html#FTN.AEN24713" name="AEN24713">
     <span class="footnote">
      [1]
     </span>
    </a>
   </p>
   <div class="EXAMPLE">
    <a name="VIEWDATA">
    </a>
    <p>
     <b>
      Example N-2.
      <i class="FIRSTTERM">
       viewdata.sh
      </i>
      : Shell Script Conversion
	of VIEWDATA.BAT
     </b>
    </p>
    <div>
     <p>
      <font color="#000000">
       <pre class="PROGRAMLISTING">#!/bin/bash
# viewdata.sh
# Conversion of VIEWDATA.BAT to shell script.

DATAFILE=/home/bozo/datafiles/book-collection.data
ARGNO=1

# @ECHO OFF                 Command unnecessary here.

if [ $# -lt "$ARGNO" ]    # IF !%1==! GOTO VIEWDATA
then
  less $DATAFILE          # TYPE C:\MYDIR\BOOKLIST.TXT | MORE
else
  grep "$1" $DATAFILE     # FIND "%1" C:\MYDIR\BOOKLIST.TXT
fi  

exit 0                    # :EXIT0

#  GOTOs, labels, smoke-and-mirrors, and flimflam unnecessary.
#  The converted script is short, sweet, and clean,
#+ which is more than can be said for the original.</pre>
      </font>
     </p>
    </div>
   </div>
   <p>
    Ted Davis'
    <a href="http://www.maem.umr.edu/batch/" target="_top">
     Shell
	Scripts on the PC
    </a>
    site had a set of comprehensive
	tutorials on the old-fashioned art of batch file
	programming. Unfortunately the page has vanished without a
	trace.
   </p>
  </div>
  <h3 class="FOOTNOTES">
   Notes
  </h3>
  <div>
   <p>
    <a href="dosbatch.html#AEN24713" name="FTN.AEN24713">
     <span class="footnote">
      [1]
     </span>
    </a>
   </p>
   <p>
    <p>
     Various readers have suggested modifications
	of the above batch file to prettify it and make it more
	compact and efficient. In the opinion of the
     <em>
      ABS
	Guide
     </em>
     author, this is wasted effort. A Bash script
	can access a DOS filesystem, or even an NTFS partition (with
	the help of
     <a href="http://www.ntfs-3g.org" target="_top">
      ntfs-3g
     </a>
     )
	to do batch or scripted operations.
    </p>
   </p>
  </div>
 </body>
</html>