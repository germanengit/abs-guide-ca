.. raw:: html

   <div class="NAVHEADER">

.. raw:: html

   <table border="0" cellpadding="0" cellspacing="0" summary="Header navigation table" width="100%">

.. raw:: html

   <tr>

.. raw:: html

   <th align="center" colspan="3">

Advanced Bash-Scripting Guide:

.. raw:: html

   </th>

.. raw:: html

   </tr>

.. raw:: html

   <tr>

.. raw:: html

   <td align="left" valign="bottom" width="10%">

`Prev <regexp.html>`__

.. raw:: html

   </td>

.. raw:: html

   <td align="center" valign="bottom" width="80%">

Chapter 18. Regular Expressions

.. raw:: html

   </td>

.. raw:: html

   <td align="right" valign="bottom" width="10%">

`Next <globbingref.html>`__

.. raw:: html

   </td>

.. raw:: html

   </tr>

.. raw:: html

   </table>

--------------

.. raw:: html

   </div>

.. raw:: html

   <div class="SECT1">

  18.1. A Brief Introduction to Regular Expressions
==================================================

An expression is a string of characters. Those characters having an
interpretation above and beyond their literal meaning are called
*metacharacters* . A quote symbol, for example, may denote speech by a
person, *ditto* , or a meta-meaning ` [1]  <x17129.html#FTN.AEN17134>`__
for the symbols that follow. Regular Expressions are sets of characters
and/or metacharacters that match (or specify) patterns.

A Regular Expression contains one or more of the following:

-  *A character set* . These are the characters retaining their literal
   meaning. The simplest type of Regular Expression consists *only* of a
   character set, with no metacharacters.

-  

   *An anchor* . These designate ( *anchor* ) the position in the line
   of text that the RE is to match. For example, ^ , and $ are anchors.

-  *Modifiers* . These expand or narrow ( *modify* ) the range of text
   the RE is to match. Modifiers include the asterisk, brackets, and the
   backslash.

The main uses for Regular Expressions ( *RE* s) are text searches and
string manipulation. An RE *matches* a single character or a set of
characters -- a string or a part of a string.

-   The asterisk -- \* -- matches any number of repeats of the character
   string or RE preceding it, including *zero* instances.

    "1133\*" matches
   ``                 11 +           one or more 3's               `` :
   ``                 113               `` ,
   ``                 1133               `` ,
   ``                 1133333               `` , and so forth.

-   The *dot* -- . -- matches any one character, except a newline. ` [2]
    <x17129.html#FTN.AEN17189>`__

    "13." matches
   ``                 13 + at          least one of any character (including a          space)               ``
   : ``                 1133               `` ,
   ``                 11333               `` , but not
   ``                 13               `` (additional character
   missing).

   See `Example 16-18 <textproc.html#CWSOLVER>`__ for a demonstration of
   *dot single-character* matching.

-   The caret -- ^ -- matches the beginning of a line, but sometimes,
   depending on context, negates the meaning of a set of characters in
   an RE.

-  

   The dollar sign -- $ -- at the end of an RE matches the end of a
   line.

    "XXX$" matches XXX at the end of a line.

    "^$" matches blank lines.

-  

   Brackets -- [...] -- enclose a set of characters to match in a single
   RE.

    "[xyz]" matches any one of the characters
   ``                 x               `` ,
   ``                 y               `` , or
   ``                 z               `` .

    "[c-n]" matches any one of the characters in the range
   ``                 c               `` to
   ``                 n               `` .

    "[B-Pk-y]" matches any one of the characters in the ranges
   ``                 B               `` to
   ``                 P               `` and
   ``                 k               `` to
   ``                 y               `` .

    "[a-z0-9]" matches any single lowercase letter or any digit.

    "[^b-d]" matches any character *except* those in the range
   ``                 b               `` to
   ``                 d               `` . This is an instance of ^
   negating or inverting the meaning of the following RE (taking on a
   role similar to ! in a different context).

   Combined sequences of bracketed characters match common word
   patterns. "[Yy][Ee][Ss]" matches
   ``                 yes               `` ,
   ``                 Yes               `` ,
   ``                 YES               `` ,
   ``                 yEs               `` , and so forth.
   "[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]" matches any Social
   Security number.

-  

   The backslash -- \\ -- `escapes <escapingsection.html#ESCP>`__ a
   special character, which means that character gets interpreted
   literally (and is therefore no longer *special* ).

   A "\\$" reverts back to its literal meaning of "$" , rather than its
   RE meaning of end-of-line. Likewise a "\\\\" has the literal meaning
   of "\\" .

-  

   `Escaped <escapingsection.html#ESCP>`__ "angle brackets" -- \\<...\\>
   -- mark word boundaries.

   The angle brackets must be escaped, since otherwise they have only
   their literal character meaning.

    "\\<the\\>" matches the word "the," but not the words "them,"
   "there," "other," etc.

   +--------------------------+--------------------------+--------------------------+
   | .. code:: SCREEN         |
   |                          |
   |     bash$ cat textfile   |
   |     This is line 1, of w |
   | hich there is only one i |
   | nstance.                 |
   |      This is the only in |
   | stance of line 2.        |
   |      This is line 3, ano |
   | ther line.               |
   |      This is line 4.     |
   |                          |
   |                          |
   |     bash$ grep 'the' tex |
   | tfile                    |
   |     This is line 1, of w |
   | hich there is only one i |
   | nstance.                 |
   |      This is the only in |
   | stance of line 2.        |
   |      This is line 3, ano |
   | ther line.               |
   |                          |
   |                          |
   |     bash$ grep '\<the\>' |
   |  textfile                |
   |     This is the only ins |
   | tance of line 2.         |
   |                          |
                             
   +--------------------------+--------------------------+--------------------------+

+--------------------------------------------------------------------------+
| .. raw:: html                                                            |
|                                                                          |
|    <div class="SIDEBAR">                                                 |
|                                                                          |
| The only way to be certain that a particular RE works is to test it.     |
|                                                                          |
| +--------------------------+--------------------------+----------------- |
| ---------+                                                               |
| | .. code:: PROGRAMLISTING |                                             |
| |                          |                                             |
| |     TEST FILE: tstfile   |                                             |
| |                          |                                             |
| | # No match.              |                                             |
| |                          |                                             |
| |                          |                                             |
| | # No match.              |                                             |
| |     Run   grep "1133*"   |                                             |
| | on this file.            |                                             |
| | # Match.                 |                                             |
| |                          |                                             |
| |                          |                                             |
| | # No match.              |                                             |
| |                          |                                             |
| |                          |                                             |
| | # No match.              |                                             |
| |     This line contains t |                                             |
| | he number 113.           |                                             |
| | # Match.                 |                                             |
| |     This line contains t |                                             |
| | he number 13.            |                                             |
| | # No match.              |                                             |
| |     This line contains t |                                             |
| | he number 133.           |                                             |
| | # No match.              |                                             |
| |     This line contains t |                                             |
| | he number 1133.          |                                             |
| | # Match.                 |                                             |
| |     This line contains t |                                             |
| | he number 113312.        |                                             |
| | # Match.                 |                                             |
| |     This line contains t |                                             |
| | he number 1112.          |                                             |
| | # No match.              |                                             |
| |     This line contains t |                                             |
| | he number 113312312.     |                                             |
| | # Match.                 |                                             |
| |     This line contains n |                                             |
| | o numbers at all.        |                                             |
| | # No match.              |                                             |
|                                                                          |
| +--------------------------+--------------------------+----------------- |
| ---------+                                                               |
|                                                                          |
| +--------------------------+--------------------------+----------------- |
| ---------+                                                               |
| | .. code:: SCREEN         |                                             |
| |                          |                                             |
| |     bash$ grep "1133*" t |                                             |
| | stfile                   |                                             |
| |     Run   grep "1133*"   |                                             |
| | on this file.            |                                             |
| | # Match.                 |                                             |
| |      This line contains  |                                             |
| | the number 113.          |                                             |
| |  # Match.                |                                             |
| |      This line contains  |                                             |
| | the number 1133.         |                                             |
| |  # Match.                |                                             |
| |      This line contains  |                                             |
| | the number 113312.       |                                             |
| |  # Match.                |                                             |
| |      This line contains  |                                             |
| | the number 113312312.    |                                             |
| |  # Match.                |                                             |
| |                          |                                             |
|                                                                          |
| +--------------------------+--------------------------+----------------- |
| ---------+                                                               |
|                                                                          |
| .. raw:: html                                                            |
|                                                                          |
|    </div>                                                                |
                                                                          
+--------------------------------------------------------------------------+

-  

   .. raw:: html

      <div class="FORMALPARA">

   ** Extended REs.** Additional metacharacters added to the basic set.
   Used in `egrep <textproc.html#EGREPREF>`__ ,
   `awk <awk.html#AWKREF>`__ , and `Perl <wrapper.html#PERLREF>`__ .

   .. raw:: html

      </div>

-  

   The question mark -- ? -- matches zero or one of the previous RE. It
   is generally used for matching single characters.

-  

   The plus -- + -- matches one or more of the previous RE. It serves a
   role similar to the \* , but does *not* match zero occurrences.

   +--------------------------+--------------------------+--------------------------+
   | .. code:: PROGRAMLISTING |
   |                          |
   |     # GNU versions of se |
   | d and awk can use "+",   |
   |     # but it needs to be |
   |  escaped.                |
   |                          |
   |     echo a111b | sed -ne |
   |  '/a1\+b/p'              |
   |     echo a111b | grep 'a |
   | 1\+b'                    |
   |     echo a111b | gawk '/ |
   | a1+b/'                   |
   |     # All of above are e |
   | quivalent.               |
   |                          |
   |     # Thanks, S.C.       |
                             
   +--------------------------+--------------------------+--------------------------+

-  `Escaped <escapingsection.html#ESCP>`__ "curly brackets" -- \\{ \\}
   -- indicate the number of occurrences of a preceding RE to match.

   It is necessary to escape the curly brackets since they have only
   their literal character meaning otherwise. This usage is technically
   not part of the basic RE set.

    "[0-9]\\{5\\}" matches exactly five digits (characters in the range
   of 0 to 9).

   .. raw:: html

      <div class="NOTE">

   +----------------+----------------+----------------+----------------+----------------+
   | |Note|         |
   | Curly brackets |
   | are not        |
   | available as   |
   | an RE in the   |
   | "classic"      |
   | (non-POSIX     |
   | compliant)     |
   | version of     |
   | `awk <awk.html |
   | #AWKREF>`__    |
   | . However, the |
   | GNU extended   |
   | version of     |
   | *awk* ,        |
   | **gawk** , has |
   | the            |
   | ``             |
   | --re-interval  |
   |           ``   |
   | option that    |
   | permits them   |
   | (without being |
   | escaped).      |
   |                |
   | +------------- |
   | -------------+ |
   | -------------- |
   | ------------+- |
   | -------------- |
   | -----------+   |
   | | .. code:: SC |
   | REEN         | |
   | |              |
   |              | |
   | |     bash$ ec |
   | ho 2222 | ga | |
   | | wk --re-inte |
   | rval '/2{3}/ | |
   | | '            |
   |              | |
   | |     2222     |
   |              | |
   | |              |
   |              | |
   |                |
   |                |
   | +------------- |
   | -------------+ |
   | -------------- |
   | ------------+- |
   | -------------- |
   | -----------+   |
   |                |
   | **Perl** and   |
   | some **egrep** |
   | versions do    |
   | not require    |
   | escaping the   |
   | curly          |
   | brackets.      |
   +----------------+----------------+----------------+----------------+----------------+

   .. raw:: html

      </div>

-  

   Parentheses -- **( )** -- enclose a group of REs. They are useful
   with the following " \| " operator and in `substring
   extraction <string-manipulation.html#EXPRPAREN>`__ using
   `expr <moreadv.html#EXPRREF>`__ .

-  The -- **\|** -- "or" RE operator matches any of a set of alternate
   characters.

   +--------------------------+--------------------------+--------------------------+
   | .. code:: SCREEN         |
   |                          |
   |     bash$ egrep 're(a|e) |
   | d' misc.txt              |
   |     People who read seem |
   |  to be better informed t |
   | han those who do not.    |
   |      The clarinet produc |
   | es sound by the vibratio |
   | n of its reed.           |
   |                          |
                             
   +--------------------------+--------------------------+--------------------------+

.. raw:: html

   <div class="NOTE">

+--------------------------------------+--------------------------------------+
| |Note|                               |
| Some versions of **sed** , **ed** ,  |
| and **ex** support escaped versions  |
| of the extended Regular Expressions  |
| described above, as do the GNU       |
| utilities.                           |
+--------------------------------------+--------------------------------------+

.. raw:: html

   </div>

-  

   .. raw:: html

      <div class="FORMALPARA">

   ** POSIX Character Classes.**
   ``                   [:class:]                 ``

   .. raw:: html

      </div>

   This is an alternate method of specifying a range of characters to
   match.

-  ``                 [:alnum:]               `` matches alphabetic or
   numeric characters. This is equivalent to
   ``                 A-Za-z0-9               `` .

-  ``                 [:alpha:]               `` matches alphabetic
   characters. This is equivalent to
   ``                 A-Za-z               `` .

-  ``                 [:blank:]               `` matches a space or a
   tab.

-  ``                 [:cntrl:]               `` matches control
   characters.

-  ``                 [:digit:]               `` matches (decimal)
   digits. This is equivalent to ``                 0-9               ``
   .

-  ``                 [:graph:]               `` (graphic printable
   characters). Matches characters in the range of
   `ASCII <special-chars.html#ASCIIDEF>`__ 33 - 126. This is the same as
   ``                 [:print:]               `` , below, but excluding
   the space character.

-  ``                 [:lower:]               `` matches lowercase
   alphabetic characters. This is equivalent to
   ``                 a-z               `` .

-  ``                 [:print:]               `` (printable characters).
   Matches characters in the range of ASCII 32 - 126. This is the same
   as ``                 [:graph:]               `` , above, but adding
   the space character.

-   ``                 [:space:]               `` matches whitespace
   characters (space and horizontal tab).

-  ``                 [:upper:]               `` matches uppercase
   alphabetic characters. This is equivalent to
   ``                 A-Z               `` .

-  ``                 [:xdigit:]               `` matches hexadecimal
   digits. This is equivalent to
   ``                 0-9A-Fa-f               `` .

   .. raw:: html

      <div class="IMPORTANT">

   +--------------------------------------+--------------------------------------+
   | |Important|                          |
   | POSIX character classes generally    |
   | require quoting or `double           |
   | brackets <testconstructs.html#DBLBRA |
   | CKETS>`__                            |
   | ([[ ]]).                             |
   +--------------------------------------+--------------------------------------+

   .. raw:: html

      </div>

   +--------------------------+--------------------------+--------------------------+
   | .. code:: SCREEN         |
   |                          |
   |     bash$ grep [[:digit: |
   | ]] test.file             |
   |     abc=723              |
   |                          |
                             
   +--------------------------+--------------------------+--------------------------+

   +--------------------------+--------------------------+--------------------------+
   | .. code:: PROGRAMLISTING |
   |                          |
   |     # ...                |
   |     if [[ $arow =~ [[:di |
   | git:]] ]]   #  Numerical |
   |  input?                  |
   |     then       #  POSIX  |
   | char class               |
   |       if [[ $acol =~ [[: |
   | alpha:]] ]] # Number fol |
   | lowed by a letter? Illeg |
   | al!                      |
   |     # ...                |
   |     # From ktour.sh exam |
   | ple script.              |
                             
   +--------------------------+--------------------------+--------------------------+

   These character classes may even be used with
   `globbing <globbingref.html>`__ , to a limited extent.

   +--------------------------+--------------------------+--------------------------+
   | .. code:: SCREEN         |
   |                          |
   |     bash$ ls -l ?[[:digi |
   | t:]][[:digit:]]?         |
   |     -rw-rw-r--    1 bozo |
   |   bozo         0 Aug 21  |
   | 14:47 a33b               |
   |                          |
                             
   +--------------------------+--------------------------+--------------------------+

   POSIX character classes are used in `Example
   16-21 <textproc.html#EX49>`__ and `Example
   16-22 <textproc.html#LOWERCASE>`__ .

`Sed <sedawk.html#SEDREF>`__ , `awk <awk.html#AWKREF>`__ , and
`Perl <wrapper.html#PERLREF>`__ , used as filters in scripts, take REs
as arguments when "sifting" or transforming files or I/O streams. See
`Example A-12 <contributed-scripts.html#BEHEAD>`__ and `Example
A-16 <contributed-scripts.html#TREE>`__ for illustrations of this.

The standard reference on this complex topic is Friedl's *Mastering
Regular Expressions* . *Sed & Awk* , by Dougherty and Robbins, also
gives a very lucid treatment of REs. See the
`*Bibliography* <biblio.html>`__ for more information on these books.

.. raw:: html

   </div>

Notes
~~~~~

.. raw:: html

   <table border="0" class="FOOTNOTES" width="100%">

.. raw:: html

   <tr>

.. raw:: html

   <td align="LEFT" valign="TOP" width="5%">

` [1]  <x17129.html#AEN17134>`__

.. raw:: html

   </td>

.. raw:: html

   <td align="LEFT" valign="TOP" width="95%">

 A *meta-meaning* is the meaning of a term or expression on a higher
level of abstraction. For example, the *literal* meaning of *regular
expression* is an ordinary expression that conforms to accepted usage.
The *meta-meaning* is drastically different, as discussed at length in
this chapter.

.. raw:: html

   </td>

.. raw:: html

   </tr>

.. raw:: html

   <tr>

.. raw:: html

   <td align="LEFT" valign="TOP" width="5%">

` [2]  <x17129.html#AEN17189>`__

.. raw:: html

   </td>

.. raw:: html

   <td align="LEFT" valign="TOP" width="95%">

Since `sed <sedawk.html#SEDREF>`__ , `awk <awk.html#AWKREF>`__ , and
`grep <textproc.html#GREPREF>`__ process single lines, there will
usually not be a newline to match. In those cases where there is a
newline in a multiple line expression, the dot will match the newline.

+--------------------------+--------------------------+--------------------------+
| .. code:: PROGRAMLISTING |
|                          |
|     #!/bin/bash          |
|                          |
|     sed -e 'N;s/.*/[&]/' |
|  << EOF   # Here Documen |
| t                        |
|     line1                |
|     line2                |
|     EOF                  |
|     # OUTPUT:            |
|     # [line1             |
|     # line2]             |
|                          |
|                          |
|                          |
|     echo                 |
|                          |
|     awk '{ $0=$1 "\n" $2 |
| ; if (/line.1/) {print}} |
| ' << EOF                 |
|     line 1               |
|     line 2               |
|     EOF                  |
|     # OUTPUT:            |
|     # line               |
|     # 1                  |
|                          |
|                          |
|     # Thanks, S.C.       |
|                          |
|     exit 0               |
                          
+--------------------------+--------------------------+--------------------------+

.. raw:: html

   </td>

.. raw:: html

   </tr>

.. raw:: html

   </table>

.. raw:: html

   <div class="NAVFOOTER">

--------------

+--------------------------+--------------------------+--------------------------+
| `Prev <regexp.html>`__   | Regular Expressions      |
| `Home <index.html>`__    | `Up <regexp.html>`__     |
| `Next <globbingref.html> | Globbing                 |
| `__                      |                          |
+--------------------------+--------------------------+--------------------------+

.. raw:: html

   </div>

.. |Note| image:: ../images/note.gif
.. |Important| image:: ../images/important.gif
